<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin Panel - Luvyn Smart Bulb</title>
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <style>
        body {
            background: linear-gradient(135deg, #000000 0%, #1a1a1a 100%);
            color: #ffffff;
            min-height: 100vh;
            padding: 40px 20px;
        }

        .admin-section {
            background: transparent;
            padding: 40px 20px;
            min-height: 100vh;
        }

        .admin-container {
            max-width: 1200px;
            margin: 0 auto;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 20px;
            box-shadow: 0 15px 40px rgba(0, 0, 0, 0.3);
            overflow: hidden;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 215, 0, 0.1);
        }

        .admin-header {
            background: rgba(255, 215, 0, 0.1);
            color: var(--primary-color);
            padding: 30px;
            text-align: center;
            border-bottom: 1px solid rgba(255, 215, 0, 0.2);
        }

        .admin-header h2 {
            font-size: 2.5rem;
            margin: 0;
            font-weight: 700;
            color: var(--primary-color);
        }

        .admin-content {
            padding: 40px;
        }

        .admin-stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 40px;
        }

        .stat-card {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 15px;
            padding: 25px;
            text-align: center;
            border: 1px solid rgba(255, 215, 0, 0.1);
        }

        .stat-value {
            font-size: 2.5rem;
            font-weight: bold;
            color: var(--primary-color);
            margin: 10px 0;
        }

        .stat-label {
            color: #aaa;
            font-size: 1.1rem;
        }

        .orders-table-container {
            overflow-x: auto;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 10px;
            overflow: hidden;
        }

        th, td {
            padding: 15px;
            text-align: left;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        th {
            background: rgba(255, 215, 0, 0.1);
            color: var(--primary-color);
            font-weight: 600;
        }

        tr:last-child td {
            border-bottom: none;
        }

        .order-status {
            padding: 5px 10px;
            border-radius: 20px;
            font-size: 0.9rem;
            font-weight: bold;
            text-align: center;
            min-width: 80px;
        }

        .status-pending {
            background: rgba(243, 156, 18, 0.2);
            color: #f39c12;
        }

        .status-accepted {
            background: rgba(46, 204, 113, 0.2);
            color: #2ecc71;
        }

        .status-rejected {
            background: rgba(231, 76, 60, 0.2);
            color: #e74c3c;
        }

        .status-shipped {
            background: rgba(241, 196, 15, 0.2);
            color: #f1c40f;
        }

        .status-delivered {
            background: rgba(52, 152, 219, 0.2);
            color: #3498db;
        }

        .action-buttons {
            display: flex;
            gap: 10px;
        }

        .btn-accept {
            background: rgba(46, 204, 113, 0.2);
            color: #2ecc71;
            border: 1px solid #2ecc71;
        }

        .btn-accept:hover {
            background: rgba(46, 204, 113, 0.4);
        }

        .btn-reject {
            background: rgba(231, 76, 60, 0.2);
            color: #e74c3c;
            border: 1px solid #e74c3c;
        }

        .btn-reject:hover {
            background: rgba(231, 76, 60, 0.4);
        }

        .no-orders {
            text-align: center;
            padding: 40px;
            color: #aaa;
        }

        .no-orders i {
            font-size: 3rem;
            margin-bottom: 15px;
            color: var(--primary-color);
            opacity: 0.5;
        }

        @media (max-width: 768px) {
            .admin-content {
                padding: 20px;
            }

            .admin-header h2 {
                font-size: 2rem;
            }

            .action-buttons {
                flex-direction: column;
            }

            table {
                display: block;
                overflow-x: auto;
                white-space: nowrap;
            }
        }
    </style>
</head>
<body>
    <header>
        <div class="container">
            <nav>
                <a href="index.html" class="logo">
                    <img src="assets/logobaru.png" alt="Luvyn Logo" style="height: 40px; width: auto;">
                </a>
                <div class="nav-menu" id="nav-menu">
                    <ul class="nav-links">
                        <li><a href="index.html">Home</a></li>
                        <li><a href="admin-panel.html" class="active">Admin Panel</a></li>
                        <li><a href="https://www.instagram.com/__luvynlight/" target="_blank"><i class="fab fa-instagram"></i> Instagram</a></li>
                        <li>
                            <div class="auth-buttons">
                                <button id="logoutBtn" class="btn btn-secondary">Logout</button>
                                <span id="userDisplay" style="margin-left: 10px; color: var(--primary-color);">Admin</span>
                            </div>
                        </li>
                    </ul>
                </div>
                <div class="hamburger" id="hamburger">
                    <span></span>
                    <span></span>
                    <span></span>
                </div>
            </nav>
        </div>
    </header>

    <section class="admin-section">
        <div class="admin-container">
            <div class="admin-header">
                <h2>Admin Panel</h2>
                <p>Manage orders and monitor store activity</p>
            </div>

            <div class="admin-content">
                <div class="admin-stats">
                    <div class="stat-card">
                        <div class="stat-value" id="totalOrders">0</div>
                        <div class="stat-label">Total Orders</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value" id="pendingOrders">0</div>
                        <div class="stat-label">Pending Orders</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value" id="acceptedOrders">0</div>
                        <div class="stat-label">Accepted Orders</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value" id="rejectedOrders">0</div>
                        <div class="stat-label">Rejected Orders</div>
                    </div>
                </div>

                <h3>All Orders</h3>
                <div class="orders-table-container">
                    <table id="ordersTable">
                        <thead>
                            <tr>
                                <th>Order ID</th>
                                <th>User</th>
                                <th>Product</th>
                                <th>Date</th>
                                <th>Total</th>
                                <th>Status</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="ordersBody">
                            <!-- Orders will be loaded dynamically -->
                            <tr>
                                <td colspan="7" class="no-orders-data">
                                    <div class="no-orders">
                                        <i class="fas fa-spinner fa-spin"></i>
                                        <h3>Loading Orders...</h3>
                                    </div>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </section>

    <script>
        // Mobile menu toggle
        const hamburger = document.getElementById('hamburger');
        const navMenu = document.getElementById('nav-menu');

        hamburger?.addEventListener('click', function() {
            hamburger.classList.toggle('active');
            navMenu.classList.toggle('active');
        });

        // Close mobile menu when clicking on a link
        document.querySelectorAll('.nav-links a').forEach(link => {
            link.addEventListener('click', () => {
                hamburger?.classList.remove('active');
                navMenu?.classList.remove('active');
            });
        });

        // Check if user is admin on page load
        document.addEventListener('DOMContentLoaded', function() {
            const isLoggedIn = localStorage.getItem('isLoggedIn');
            const currentUser = JSON.parse(localStorage.getItem('currentUser'));

            if (isLoggedIn !== 'true' || !currentUser || currentUser.type !== 'admin') {
                // Redirect to login if not admin
                alert('Access denied. Admin privileges required.');
                window.location.href = 'login.html';
                return;
            }

            // Update UI for admin
            document.getElementById('userDisplay').textContent = currentUser.name || 'Admin';

            // Load orders
            loadOrders();
        });

        // Handle logout
        document.getElementById('logoutBtn').addEventListener('click', function() {
            if (confirm('Are you sure you want to logout?')) {
                // Clear stored user data
                localStorage.removeItem('isLoggedIn');
                localStorage.removeItem('currentUser');

                // Redirect to login page
                window.location.href = 'login.html';
            }
        });

        // Function to load orders
        function loadOrders() {
            // In a real application, this would fetch from a server
            // For demo purposes, we'll use localStorage to simulate orders
            
            const allOrders = JSON.parse(localStorage.getItem('orders')) || [];
            
            // Update stats
            document.getElementById('totalOrders').textContent = allOrders.length;
            document.getElementById('pendingOrders').textContent = allOrders.filter(o => o.status === 'pending').length;
            document.getElementById('acceptedOrders').textContent = allOrders.filter(o => o.status === 'accepted').length;
            document.getElementById('rejectedOrders').textContent = allOrders.filter(o => o.status === 'rejected').length;
            
            const ordersBody = document.getElementById('ordersBody');
            
            if (allOrders.length === 0) {
                ordersBody.innerHTML = `
                    <tr>
                        <td colspan="7" class="no-orders-data">
                            <div class="no-orders">
                                <i class="fas fa-box-open"></i>
                                <h3>No Orders Found</h3>
                                <p>There are no orders to display.</p>
                            </div>
                        </td>
                    </tr>
                `;
                return;
            }
            
            let ordersHTML = '';
            
            allOrders.forEach(order => {
                const statusClass = getStatusClass(order.status);
                const statusText = getStatusText(order.status);
                
                ordersHTML += `
                    <tr>
                        <td>${order.id}</td>
                        <td>${order.user}</td>
                        <td>${order.product || 'Luvyn Premium Smart Bulb'}</td>
                        <td>${formatDate(order.date)}</td>
                        <td>${formatCurrency(order.total || 0)}</td>
                        <td><span class="order-status ${statusClass}">${statusText}</span></td>
                        <td class="action-buttons">
                            <button class="btn btn-accept" onclick="updateOrderStatus('${order.id}', 'accepted')">Accept</button>
                            <button class="btn btn-reject" onclick="updateOrderStatus('${order.id}', 'rejected')">Reject</button>
                        </td>
                    </tr>
                `;
            });
            
            ordersBody.innerHTML = ordersHTML;
        }

        // Function to update order status
        function updateOrderStatus(orderId, newStatus) {
            if (!confirm(`Are you sure you want to ${newStatus} this order?`)) {
                return;
            }
            
            const allOrders = JSON.parse(localStorage.getItem('orders')) || [];
            const orderIndex = allOrders.findIndex(order => order.id === orderId);
            
            if (orderIndex !== -1) {
                allOrders[orderIndex].status = newStatus;
                localStorage.setItem('orders', JSON.stringify(allOrders));
                
                // Show confirmation
                alert(`Order ${orderId} has been ${newStatus} successfully.`);
                
                // Reload orders
                loadOrders();
            } else {
                alert('Order not found.');
            }
        }

        // Helper function to get status class
        function getStatusClass(status) {
            switch(status) {
                case 'pending': return 'status-pending';
                case 'accepted': return 'status-accepted';
                case 'rejected': return 'status-rejected';
                case 'shipped': return 'status-shipped';
                case 'delivered': return 'status-delivered';
                default: return 'status-pending';
            }
        }

        // Helper function to get status text
        function getStatusText(status) {
            switch(status) {
                case 'pending': return 'Pending';
                case 'accepted': return 'Accepted';
                case 'rejected': return 'Rejected';
                case 'shipped': return 'Shipped';
                case 'delivered': return 'Delivered';
                default: return 'Pending';
            }
        }

        // Helper function to format date
        function formatDate(dateString) {
            const date = new Date(dateString);
            return date.toLocaleDateString('id-ID', {
                year: 'numeric',
                month: 'short',
                day: 'numeric'
            });
        }

        // Helper function to format currency
        function formatCurrency(amount) {
            return `Rp ${amount.toLocaleString('id-ID')}`;
        }

        // Listen for storage changes to reload orders if they're updated from another tab/window
        window.addEventListener('storage', function(e) {
            if (e.key === 'orders') {
                loadOrders();
            }
        });
    </script>
</body>
</html>